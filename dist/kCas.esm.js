function e(e,t,n,o,r,a,c){try{var i=e[a](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(o,r)}function t(t){return function(){var n=this,o=arguments;return new Promise((function(r,a){var c=t.apply(n,o);function i(t){e(c,r,a,i,u,"next",t)}function u(t){e(c,r,a,i,u,"throw",t)}i(void 0)}))}}function n(e,t){for(var n=0;t.length>n;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}const o=function(e,t,n={}){return new Promise((o,r)=>{const a=new XMLHttpRequest;let c=t,i=null;if("get"===e.toLowerCase()){const{params:e={}}=n;Object.keys(e).forEach((t,n)=>{c+=`${0===n?"?":"&"}${t}=${e[t]}`})}else i=JSON.stringify(n);a.open(e,c),a.setRequestHeader("content-type","application/json;charset=UTF-8"),"string"==typeof n&&(a.setRequestHeader("content-type","application/x-www-form-urlencoded"),i=n),a.onload=function(){if(200===this.status){const{response:e}=this;o(e&&JSON.parse(e))}else a.onerror()},a.onerror=function(){const{status:e,response:t}=this;r({status:e,response:t&&JSON.parse(t)})},a.send(i)})};function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href,n=RegExp("".concat(e,"=([^&]*)")),o=t.match(n);return o&&o[1]}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=void 0===t?window.location.href:t,o=e.key,r=void 0===o?"ticket|language|co(.?)ntry|variant":o,a=RegExp("[?|&]?(".concat(r,")=([^&]*)"),"g");return n.replace(a,"")}function c(){for(var e=[],t=0;10>t;t+=1)e[t]="abcdef".substr(Math.floor(6*Math.random()),1);return e.join("")+(new Date).getTime()}o.get=function(e,t){return o("GET",e,t)},o.post=function(e,t){return o("POST",e,t)},o.put=function(e,t){return o("PUT",e,t)},o.delete=function(e,t){return o("DELETE",e,t)};var i={getDeviceId:c,getRemoveCasKeyUrl:a,getUrlVlaueByKey:r},u=function(){function e(t){var n=t.appKey,o=t.appSecret,r=t.authService,a=t.casService,c=t.casloginPath,i=void 0===c?"/cas/login":c,u=t.caslogoutPath,s=void 0===u?"/cas/logout":u,h=t.authTokenPath,l=void 0===h?"/gateway/check_token":h,f=t.authTicketPath,p=void 0===f?"/user/cas/knock":f,v=t.authLogoutPath,g=void 0===v?"/user/auth/logout":v,k=t.authRolesPath,d=void 0===k?"/dev-basp-user/indexModule/queryRoles":k;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appKey=n,this.appSecret=o,this.authTokenUrl=r+l,this.authTicketUrl=r+p,this.authLogoutUrl=r+g,this.authRolesUrl=r+d,this.casloginURL=a+i,this.caslogoutURL=a+s}var i,u,s,h,l;return i=e,u=[{key:"login",value:(l=t(regeneratorRuntime.mark((function t(){var n,o,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a(),t.next=3,this.casLogin();case 3:return o=t.sent,t.next=6,this.authRoles().catch((function(){r.authLogout(),e.removeToken(),window.location.href="".concat(r.casloginURL,"?service=").concat(n)}));case 6:return o.roles=(t.sent||{}).result,t.abrupt("return",o);case 10:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"casLogin",value:(h=t(regeneratorRuntime.mark((function t(){var n,o,c,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r("ticket"),o=a(),t.next=4,this.authCheckToken().catch((function(){n||(i.authLogout(),window.location.href="".concat(i.casloginURL,"?service=").concat(o))}));case 4:if(!(c=t.sent)){t.next=7;break}return t.abrupt("return",c);case 7:return t.next=9,this.authCheckTick(n).catch((function(){i.authLogout(),window.location.href="".concat(i.casloginURL,"?service=").concat(o)}));case 9:if(!(c=t.sent)||!c.errorMessage){t.next=12;break}return t.abrupt("return",Promise.reject(c.errorMessage));case 12:return c&&c.obj.token&&e.setToken(c.obj.token),t.abrupt("return",c);case 14:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"authRoles",value:function(){return o.get(this.authRolesUrl)}},{key:"authCheckTick",value:function(e){var t=this.appKey,n=this.appSecret,r=this.authTicketUrl,i={ticket:e,service:a(),appKey:t,appSecret:n,deviceId:c()};return o.post(r,i)}},{key:"authCheckToken",value:function(){return o.get(this.authTokenUrl)}},{key:"authLogout",value:function(){return o.get(this.authLogoutUrl).catch((function(){e.removeToken()}))}}],s=[{key:"setToken",value:function(e){document.cookie="token=".concat(e)}},{key:"removeToken",value:function(){var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)document.cookie="".concat(e[t],"=0;expires=").concat(new Date(0).toUTCString())}}],u&&n(i.prototype,u),s&&n(i,s),e}();export default u;export{u as kCas,i as kCasUtils};
